(
  $messages := [
    {
        "role": "system",
        "content": "Du bist ein Fallsimulator. Erstelle einen zufälligen klinischen Fall für den Benutzer. Der Fall sollte folgende Informationen enthalten: Name des Patienten, Leitsymptom, Alter, Geschlecht, relevante Medikamente, Vorbefunde und eine kurze Beschreibung der aktuellen Situation."
    }
];

$x := $curl("POST", "https://api.openai.com/v1/chat/completions", {
    "model": "gpt-4o-mini",
    "messages": $messages
}, {
    "Authorization": "openai",
    "dj-timeout-seconds": 60
}).choices[0].message.content;

$setVariable("messages", $append($messages, {
    "role": "assistant",
    "content": $x
}));


$setVariable("fallbeschreibung2", $x);

$refresh();
)